<html><head><title>UVMC Command API Example - Print Topology</title><link rel="stylesheet" type="text/css" href="../../../styles/main.css"><script language=JavaScript src="../../../javascript/main.js"></script></head><body class="FramedContentPage" onLoad="NDOnLoad()"><script language=JavaScript><!--
if (browserType) {document.write("<div class=" + browserType + ">");if (browserVer) {document.write("<div class=" + browserVer + ">"); }}// --></script>

<!--  Generated by Natural Docs, version Development Release 01-12-2008 (1.35 base) -->
<!--  http://www.naturaldocs.org  -->

<!-- saved from url=(0026)http://www.naturaldocs.org --> 








 <!--TOP - START OF CONTENT-->
<div id=Content>


 <!--CONTENT index=0 -->
<div class="CSection"><div class=CTopic id=MainTopic><h1 class=CTitle><a name="UVMC_Command_API_Example-Print_Topology" href="../../../uvmc/examples_ovm/commands/ex_print_topology.cpp">UVMC Command API Example - Print Topology</a></h1><div class=CBody><p>This example shows how to print the UVM testbench topology from SC.</p><p>First, we wait for the UVM&rsquo;s build phase to start, then print the UVM topology.&nbsp; At this point only the top-level component exists.</p><p>Then, we wait for the build phase to end, then print the topology once more.&nbsp; This time, all the UVM components exist and you see</p>

<!--START_ND_SUMMARY index=0-->
<div class=Summary><div class=STitle>Summary</div><div class=SBorder><table border=0 cellspacing=0 cellpadding=0 class=STable>
  <!-- index=0 -->

<tr class="SMain"><td colspan=2 class=SEntry><a href="#UVMC_Command_API_Example-Print_Topology" >UVMC Command API Example - Print Topology</a></td></tr>
<tr class=SMain><td colspan=2 class=SWideDescription>This example shows how to print the UVM testbench topology from SC.</td></tr></table></div></div><!--END_ND_SUMMARY-->
</div></div></div>




 <!--CONTENT index=1 -->
<div class="CClass"><div class=CTopic><h2 class=CTitle><a name="top" href="../../../uvmc/examples_ovm/commands/ex_print_topology.cpp">top</a></h2><div class=CBody><p>Our top-level SC module does the following</p><ul><li>Creates an instance of a generic <a href="../converters/consumer-cpp.html#consumer" class=LClass >consumer</a>.&nbsp; The consumer merely prints the transactions it receives side and sends them out its analysis port.</li><li>Spawn a thread function, <i>show_uvm_print_topology</i></li><li>Register the consumer&rsquo;s ports for UVMC connection.</li></ul><blockquote><pre>#include &quot;systemc.h&quot;
#include &quot;tlm.h&quot;
#include &lt;string&gt;
#include &lt;iostream&gt;

using namespace std;
using namespace sc_core;
using namespace tlm;

#include &quot;uvmc.h&quot;
#include &quot;uvmc_macros.h&quot;
using namespace uvmc;

#include &quot;consumer.cpp&quot;


SC_MODULE(top)
{
  consumer cons;

  SC_CTOR(top) : cons(&quot;consumer&quot;) {
    SC_THREAD(show_uvm_print_topology);
    uvmc_connect(cons.in,&quot;foo&quot;);
    uvmc_connect(cons.ap,&quot;bar&quot;);
  }

  void show_uvm_print_topology();

};</pre></blockquote>

<!--START_ND_SUMMARY index=1-->
<div class=Summary><div class=STitle>Summary</div><div class=SBorder><table border=0 cellspacing=0 cellpadding=0 class=STable>
  <!-- index=1 -->

<tr class="SClass"><td colspan=2 class=SEntry><a href="#top" >top</a></td></tr>
<tr class=SMain><td colspan=2 class=SWideDescription>Our top-level SC module does the following</td></tr>
  <!-- index=2 -->

<tr class="SMethod SIndent1 SMarked"><td class=SEntry><a href="#top.show_uvm_print_topology" >show_uvm_print_topology</a></td><td class=SDescription>The <i>show_uvm_print_topology</i> waits for UVM to start its <i>build_phase</i>, then prints UVM topology. </td></tr>
  <!-- index=3 -->

<tr class="SGroup SIndent1"><td class=SEntry><a href="#top.sc_main" >sc_main</a></td><td class=SDescription>Creates an instance of our <a href="#top" class=LClass id=link1 onMouseOver="ShowTip(event, 'tt1', 'link1')" onMouseOut="HideTip('tt1')">top</a> module then calls <i>sc_start</i> to start SC simulation.</td></tr></table></div></div><!--END_ND_SUMMARY-->
</div></div></div>




 <!--CONTENT index=2 -->
<div class="CMethod"><div class=CTopic><h3 class=CTitle><a name="top.show_uvm_print_topology" href="../../../uvmc/examples_ovm/commands/ex_print_topology.cpp">show_uvm_print_topology</a></h3><div class=CBody><p>The <i>show_uvm_print_topology</i> waits for UVM to start its <i>build_phase</i>, then prints UVM topology.&nbsp; At this point only the top-level component exists.</p><p>It then waits for the <i>build_phase</i> to finish.&nbsp; This time, printing the UVM topology shows our expected testbench topology.</p></div></div></div>




 <!--CONTENT index=3 -->
<div class="CGroup"><div class=CTopic><h3 class=CTitle><a name="top.sc_main" href="../../../uvmc/examples_ovm/commands/ex_print_topology.cpp">sc_main</a></h3><div class=CBody><p>Creates an instance of our <a href="#top" class=LClass id=link2 onMouseOver="ShowTip(event, 'tt1', 'link2')" onMouseOut="HideTip('tt1')">top</a> module then calls <i>sc_start</i> to start SC simulation.</p><blockquote><pre>int sc_main(int argc, char* argv[])
{
  top t(&quot;top&quot;);
  sc_start();
  return 0;
}</pre></blockquote>

<p align=center><a name="top.sc_main" href="../../../uvmc/examples_ovm/commands/ex_print_topology.cpp">../../../uvmc/examples_ovm/commands/ex_print_topology.cpp</a></p></div>
<div class="SourceCode"><pre>
<b>//</b>
<b>//------------------------------------------------------------//</b>
<b>//   Copyright 2009-2012 Mentor Graphics Corporation          //</b>
<b>//   All Rights Reserved Worldwid                             //</b>
<b>//                                                            //</b>
<b>//   Licensed under the Apache License, Version 2.0 (the      //</b>
<b>//   "License"); you may not use this file except in          //</b>
<b>//   compliance with the License.  You may obtain a copy of   //</b>
<b>//   the License at                                           //</b>
<b>//                                                            //</b>
<b>//       http://www.apache.org/licenses/LICENSE-2.0           //</b>
<b>//                                                            //</b>
<b>//   Unless required by applicable law or agreed to in        //</b>
<b>//   writing, software distributed under the License is       //</b>
<b>//   distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR   //</b>
<b>//   CONDITIONS OF ANY KIND, either express or implied.  See  //</b>
<b>//   the License for the specific language governing          //</b>
<b>//   permissions and limitations under the License.           //</b>
<b>//------------------------------------------------------------//</b>

<b>// (begin inline source)</b>
#include "systemc.h"
#include "tlm.h"
#include <string>
#include <iostream>

using namespace std;
using namespace sc_core;
using namespace tlm;

#include "uvmc.h"
#include "uvmc_macros.h"
using namespace uvmc;

#include "consumer.cpp"


SC_MODULE(top)
{
  consumer cons;

  SC_CTOR(top) : cons("consumer") {
    SC_THREAD(show_uvm_print_topology);
    uvmc_connect(cons.in,"foo");
    uvmc_connect(cons.ap,"bar");
  }

  void show_uvm_print_topology();

};
<b>//(end inline source)</b>


void top::show_uvm_print_topology()
{
  cout << endl << endl << "Waiting for UVM to reach build phase..." << endl;
  uvmc_wait_for_phase("build", UVM_PHASE_STARTED, UVM_GTE);

  cout << endl << endl << "Topology before build phase:" << endl;
  uvmc_print_topology();

  uvmc_wait_for_phase("build", UVM_PHASE_ENDED);

  cout << endl << endl << "Topology after build phase:" << endl;
  uvmc_print_topology();
}

<b>// (begin inline source)</b>
int sc_main(int argc, char* argv[]) 
{  
  top t("top");
  sc_start();
  return 0;
}
<b>// (end inline source)</b>
</pre></div>
</div></div>

</div><!--Content-->



<!--START_ND_TOOLTIPS-->
<div class=CToolTip id="tt1"><div class=CClass>Our top-level SC module does the following</div></div><!--END_ND_TOOLTIPS-->

<script language=JavaScript><!--
if (browserType) {if (browserVer) {document.write("</div>"); }document.write("</div>");}// --></script></body></html>