<html><head><title>Regression testing</title><link rel="stylesheet" type="text/css" href="../../styles/main.css"><script language=JavaScript src="../../javascript/main.js"></script></head><body class="FramedContentPage" onLoad="NDOnLoad()"><script language=JavaScript><!--
if (browserType) {document.write("<div class=" + browserType + ">");if (browserVer) {document.write("<div class=" + browserVer + ">"); }}// --></script>

<!--  Generated by Natural Docs, version Development Release 01-12-2008 (1.35 base) -->
<!--  http://www.naturaldocs.org  -->

<!-- saved from url=(0026)http://www.naturaldocs.org --> 








 <!--TOP - START OF CONTENT-->
<div id=Content>


 <!--CONTENT index=0 -->
<div class="CSection"><div class=CTopic id=MainTopic><h1 class=CTitle><a name="Regression_testing" href="../../uvmc/docs/REGRESSION_TESTING.txt">Regression testing</a></h1><div class=CBody>

<!--START_ND_SUMMARY index=0-->
<div class=Summary><div class=STitle>Summary</div><div class=SBorder><table border=0 cellspacing=0 cellpadding=0 class=STable>
  <!-- index=0 -->

<tr class="SMain"><td colspan=2 class=SEntry><a href="#Regression_testing" >Regression testing</a></td></tr>
<tr class=SMain><td colspan=2 class=SWideDescription></td></tr>
  <!-- index=1 -->

<tr class="SGroup SIndent1"><td class=SEntry><a href="#Regression_testing_your_UVMC_examples" >Regression testing your UVMC examples</a></td><td class=SDescription>The following procedures show how to automatically regression test all the examples included in this package with a simple scheme that deploys recursive use of Makefiles applied from the root of the example tree. </td></tr>
  <!-- index=2 -->

<tr class="SGeneric SIndent2 SMarked"><td class=SEntry><a href="#Regression_tree_structure" >Regression tree structure</a></td><td class=SDescription>The <i>regression root</i> defines a <i>tree of tests</i>.</td></tr>
  <!-- index=3 -->

<tr class="SGeneric SIndent2"><td class=SEntry><a href="#Running_regression_trees_recursively" >Running regression trees recursively</a></td><td class=SDescription>The entire regression tree structure is <i>fractal</i> in nature. </td></tr>
  <!-- index=4 -->

<tr class="SGeneric SIndent2 SMarked"><td class=SEntry><a href="#Local_Env.script's" >Local Env.<span class=HB> </span>script&rsquo;s</a></td><td class=SDescription>Note that the above assumes there is a local <i>Env.script</i> present for each leaf test directory. </td></tr>
  <!-- index=5 -->

<tr class="SGeneric SIndent2"><td class=SEntry><a href="#Running_leaf_tests" >Running leaf tests</a></td><td class=SDescription>You will see that each of the leaf tests are self contained with their own <i>Makefile.&lt;tool&gt;</i> variations (where <i>&lt;tool&gt;</i> can be <i>questa</i>, <i>vcs</i>, or <i>ius</i>).</td></tr>
  <!-- index=6 -->

<tr class="SGeneric SIndent2 SMarked"><td class=SEntry><a href="#Generating_PASSED/FAILED_reports" >Generating PASSED/<span class=HB> </span>FAILED reports</a></td><td class=SDescription>Using the simple <b>grep</b> command you can easily generate a comprehensive PASSED/FAILED report.</td></tr></table></div></div><!--END_ND_SUMMARY-->
</div></div></div>




 <!--CONTENT index=1 -->
<div class="CGroup"><div class=CTopic><h3 class=CTitle><a name="Regression_testing_your_UVMC_examples" href="../../uvmc/docs/REGRESSION_TESTING.txt">Regression testing your UVMC examples</a></h3><div class=CBody><p>The following procedures show how to automatically regression test all the examples included in this package with a simple scheme that deploys recursive use of Makefiles applied from the root of the example tree.&nbsp; The same procedure can regression test all 3 vendor platforms, Questa, VCS, IUS.</p></div></div></div>




 <!--CONTENT index=2 -->
<div class="CGeneric"><div class=CTopic><h3 class=CTitle><a name="Regression_tree_structure" href="../../uvmc/docs/REGRESSION_TESTING.txt">Regression tree structure</a></h3><div class=CBody><p>The <i>regression root</i> defines a <i>tree of tests</i>.</p><p>Starting with the root, the tests are organized as a hierarchical structure of <i>tree branch node directories</i> and <i>leaf test directories</i>.</p><p>Each leaf test directory of the tree defines a specific unit test area where a given test or set of related tests sharing the same source code files are run.</p><p>And each branch node of the tree, including the regression root node itself, leads to other branch nodes, or leaf tests, or both.</p><p>Specifically for the UVM-Connect examples the <i>regression root</i> starts out at <b>$UVMC_HOME/examples/</b> and there are no branch nodes other than the regression root itself.&nbsp; Below the root node, there are 5 <i>leaf test directories</i>,</p><blockquote><pre>commands/
connections/
converters/
field_types/
xlerate.connections/
config_exts/</pre></blockquote></div></div></div>




 <!--CONTENT index=3 -->
<div class="CGeneric"><div class=CTopic><h3 class=CTitle><a name="Running_regression_trees_recursively" href="../../uvmc/docs/REGRESSION_TESTING.txt">Running regression trees recursively</a></h3><div class=CBody><p>The entire regression tree structure is <i>fractal</i> in nature.&nbsp; Any branch node reachable from the <i>regression root node</i> has the same regression run semantics as the root itself.&nbsp; And every node or leaf test has a Makefile (for Questa, VCS, IUS) that completely self documents the procedures recursing to lower nodes or running the given tests.</p><p>And the Makefile format used here is intentionally kept very &ldquo;bare-bones basic simple&rdquo; by avoiding use of some of the fancier gmake constructs.&nbsp; Again the intention is to keep things simple, intuitive, readable, maintainable.</p><p>Each intermediate tree branch node contains a <i>Makefile.&lt;tool&gt;</i> (where <i>&lt;tool&gt;</i> can be <i>questa</i>, <i>vcs</i>, or <i>ius</i>) which documents the child branch nodes and/or leaf test nodes reachable from that node by defining a <b>$(DIRS)</b> macro.&nbsp; For example in the <b>$UVMC_HOME/examples/</b> regression tree root node, the Makefile looks like this,</p><blockquote><pre>#-------------------------------------
DIRS = \
    commands \
    connections \
    converters \
    field_types \
    xlerate.connections \
    config_exts

BITS ?= 64

MAKEFILE ?= Makefile

all compile build sim check clean:
    #
    for i in $(DIRS); do \
        ../../test_drive.csh $$i $(MAKE) -f $(MAKEFILE) $@; \
    done</pre></blockquote><p><b>All</b> branch node Makefile&rsquo;s have exactly the same look as that shown above.</p><p>Each tool specific Makefile drives the main branch node Makefile as you see here for example in <i>Makefile.questa</i>,</p><blockquote><pre>all compile build sim check clean:
    $(MAKE) MAKEFILE=Makefile.questa $@</pre></blockquote><p>So, again being fractal in nature, each tree branch node in effect defines its own miniature regression root which can be run on the spot and will recurse to all child nodes and eventually leaf tests.&nbsp; Simply execute the Makefile at that particular branch node and that will happen.</p><p>Notice the reference to <b>test_drive.csh</b>.&nbsp; This is a generic drive script invokable from C-shell (csh) script that you will see placed at each regression root node that provides a structure for setting up the required environment of each leaf test and provides an option for generating a grep&rsquo;pable PASSED/FAILED report (see topic below).</p><p>The <b>test_drive.csh</b> simply has the following in it,</p><blockquote><pre>#!/bin/csh -f
cd $1;
grep -q DIRS Ma*
if ( $status == &quot;0&quot; ) then
    echo &quot;=+= ----------- `pwd`&quot;
    shift
    $*
else
    source Env.script
    shift
    echo &quot;Test Started: `date`&quot;
    $*
    if ( $status == &quot;0&quot; ) then
        echo &quot;=+= Test PASSED `pwd`&quot;
    else
        echo &quot;=+= Test FAILED `pwd`&quot;
    endif
    echo &quot;Test Ended: `date`&quot;
endif</pre></blockquote><p>so not much to it really.&nbsp; It was done that way on purpose ! The intent was to avoid an &ldquo;empire of scripts&rdquo; for running regressions by keeping things fractal, atomic, simple throughout.</p><p>So the <b>test_drive.csh</b> driver is what recurses through the regression tree all the way to the leaf test nodes.</p><p>No complex environment setup is required to run the Makefile&rsquo;s at each intermmediate tree branch node.&nbsp; This is because only leaf tests below the branch nodes are responsible for <i>self specifying</i> their own specific environment setup requirements via a C-shell (csh) script called <b>Env.script</b> explained below.</p><p>The only exception to the rule of &ldquo;no environment setup&rdquo; is that before running any of the branch node Makefile&rsquo;s, you need to define the following ENV var:</p><blockquote><pre>$DEMO_ROOT</pre></blockquote><ul><li>Be sure <b>$DEMO_ROOT</b> is set to point to a directory containing a proper <b>.toolsrc</b> file which is a master, <i>site-specific</i> tool setup script that is referenced in each Env.script.&nbsp; A sample .toolsrc is included in the $UVMC_HOME/lib/ area that you can customize for your particular site settings.&nbsp; For example,</li></ul><blockquote><pre>setenv DEMO_ROOT $UVMC_HOME/lib</pre></blockquote><ul><li>OK, now you can source your <i>Env.script</i>:</li></ul><blockquote><pre>source Env.script</pre></blockquote><p>So the <b>test_drive.csh</b> script simply sees the local Makefile and executes it.&nbsp; If it is a leaf test node, it will automatically source the <b>Env.script</b> required for that leaf test assuming the 2 basic ENV vars above have been properly set a-priori.</p></div></div></div>




 <!--CONTENT index=4 -->
<div class="CGeneric"><div class=CTopic><h3 class=CTitle><a name="Local_Env.script's" href="../../uvmc/docs/REGRESSION_TESTING.txt">Local Env.<span class=HB> </span>script&rsquo;s</a></h3><div class=CBody><p>Note that the above assumes there is a local <i>Env.script</i> present for each leaf test directory.&nbsp; You can run the tests in that individual directory by just manually sourcing the Env.script.</p><p>See <a href="OVERVIEW-txt.html#Environment_setup_template_script" class=LGeneric id=link1 onMouseOver="ShowTip(event, 'tt1', 'link1')" onMouseOut="HideTip('tt1')">Environment setup template script</a> in the intro chapter for details of how this setup script uses a <i>.toolsrc</i> master environment setup template.</p><p>As described above the recursive Makefile driven regression test driver deploys this Env.script to allow each test to self specify its environment but if you set the environment in your own way, you can just run the Makefile&rsquo;s directly as was described in the &lt;Running a UVMC example&gt; section.</p></div></div></div>




 <!--CONTENT index=5 -->
<div class="CGeneric"><div class=CTopic><h3 class=CTitle><a name="Running_leaf_tests" href="../../uvmc/docs/REGRESSION_TESTING.txt">Running leaf tests</a></h3><div class=CBody><p>You will see that each of the leaf tests are self contained with their own <i>Makefile.&lt;tool&gt;</i> variations (where <i>&lt;tool&gt;</i> can be <i>questa</i>, <i>vcs</i>, or <i>ius</i>).</p><p>Each leaf test directory also has its own <b>Env.script</b>.&nbsp; That is the file that must be sourced from a <b>PLAIN VANILLA</b> xterm csh and this is automatically done by the <b>test_driver.csh</b> drive script mentioned above.</p><p>Assuming you follow the same procedures described above prior to sourcing <b>Env.script</b>, you can easily &ldquo;manually&rdquo; run any leaf test as well.</p><p>Among the different leaf test directories you will see 3 types of Makefile&rsquo;s distinguished with different suffices.&nbsp; They have the following meanings,</p><blockquote><pre>Makefile.questa   # Mentor Graphics Questa simulator
Makefile.vcs      # Synopsys VCS simulator
Makefile.ius      # Cadence IUS simulator</pre></blockquote><ul><li>For example to run the any of the leaf tests in Questa mode,</li></ul><blockquote><pre>setenv DEMO_ROOT &lt;path to directory containing .toolsrc&gt;
source Env.script
make -f Makefile.questa BITS=64  # Note: BITS defaults to 32</pre></blockquote><ul><li>Each leaf test Makefile has 5 standard targets that are used consistently throughout the entire regression tree structure,</li></ul><blockquote><pre>all: compile build sim check clean # i.e. All of the 5 targets below.

compile:  # Analyze, synthesize HDL side
build:    # Build HVL side
sim:      # Run simulation
check:    # Check results of simulation
clean:    # Clean everything up</pre></blockquote><ul><li>The rules for PASS/FAIL are quite simple: <u>if the Makefile fails the test fails</u>, <u>if the Makefile passes the test passes</u>.&nbsp; I.e. if the Makefile can execute all 5 targets cleanly including the <b>check:</b> target without failing, then the test passes.&nbsp; That&rsquo;s it ! Again, this operation is consistent throughout all of the Makefiles you see in the entire regression tree structure.</li></ul></div></div></div>




 <!--CONTENT index=6 -->
<div class="CGeneric"><div class=CTopic><h3 class=CTitle><a name="Generating_PASSED/FAILED_reports" href="../../uvmc/docs/REGRESSION_TESTING.txt">Generating PASSED/<span class=HB> </span>FAILED reports</a></h3><div class=CBody><p>Using the simple <b>grep</b> command you can easily generate a comprehensive PASSED/FAILED report.</p><p>To do this, simply follow the branch node procedures described above but just redirect all output to a log file as follows:</p><blockquote><pre>cd &lt;any regression tree root node or branch node&gt;
gmake -f Makefile.&lt;tool&gt; |&amp; tee gmake.log</pre></blockquote><p>This will generate a full regression test report in &lsquo;gmake.log&rsquo;.</p><p>To generate a nice PASSED/FAILED report, simply grep for the pattern &ldquo;=+= Test&rdquo; as follows:</p><blockquote><pre>grep &quot;=+= Test&quot; gmake.log</pre></blockquote><p>and you will get a report that looks something like this,</p><blockquote><pre>=+= Test PASSED /.../examples/commands
=+= Test PASSED /.../examples/connections
=+= Test PASSED /.../examples/converters
=+= Test PASSED /.../examples/field_types
=+= Test PASSED /.../examples/xlerate.connections
=+= Test PASSED /.../examples/config_exts</pre></blockquote></div></div></div>

</div><!--Content-->



<!--START_ND_TOOLTIPS-->
<div class=CToolTip id="tt1"><div class=CGeneric>If you would like further guidance on a good template script that can be used for environment setups, this section details a template for environment setups that will work for all examples in included in this package and can even be used when building special target libraries, using different vendor simulators. </div></div><!--END_ND_TOOLTIPS-->

<script language=JavaScript><!--
if (browserType) {if (browserVer) {document.write("</div>"); }document.write("</div>");}// --></script></body></html>